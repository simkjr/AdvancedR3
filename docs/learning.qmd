---
title: "Draft Quarto document"
author: "Your Name"
format: html
---

## Header 1

```{r setup}
library(tidyverse)
library(targets)
tar_config_set(store = here::here("_targets"))
source(here::here("R/functions.R"))
lipidomics <- tar_read(lipidomics)
```

## Making a table

```{r}
lipidomics %>%
  group_by(metabolite) %>%
  summarise(across(value, list(mean = mean, sd = sd))) %>%
  mutate(across(where(is.numeric), \(x) round(x, digits = 1)) %>%
    mutate(MeanSD = glue::glue("{value_mean} ({value_sd})"))) %>%
  select(Metabolite = metabolite, "Mean SD" = MeanSD)
```

```{r}
#' Integrates Mean and SD to a single column
#'
#' @param data #lipidomics file 
#'
#' @returns A data.frame/tibble.
#' #export
#'
#' #examples
create_table_descriptive_stats <-
  function(data) {
    data %>%
      dplyr::group_by(metabolite) %>%
      dplyr::summarise(across(value, list(mean = mean, sd = sd))) %>%
      dplyr::mutate(across(where(is.numeric), \(x) round(x, digits = 1))) %>%
      dplyr::mutate(MeanSD = glue::glue("{value_mean} ({value_sd})")) %>%
      dplyr::select(Metabolite = metabolite, "Mean SD" = MeanSD)
  }
```

```{r}
# Use it like this, which should give the same output as before.
create_table_descriptive_stats(lipidomics)
```

## This is poorly formatted

-   Definitely should have an empty space above this list.
-   This isn't a list, why not?
